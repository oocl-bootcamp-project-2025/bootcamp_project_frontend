# åœ°å›¾ç»„ä»¶é‡æ„è¯´æ˜

## æ¦‚è¿°

å°†åŸæ¥çš„å•ä¸€ `AMapComponent.jsx` ç»„ä»¶æŒ‰åŠŸèƒ½æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„ç»„ä»¶ï¼Œæé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯å¤ç”¨æ€§ã€‚

## ç»„ä»¶ç»“æ„

### 1. MapContainer (ä¸»å®¹å™¨ç»„ä»¶)

- **æ–‡ä»¶**: `MapContainer.jsx` + `css/MapContainer.css`
- **åŠŸèƒ½**:
  - ç®¡ç†æ•´ä½“çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸ
  - åè°ƒå„å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡
  - å¤„ç†åœ°å›¾è§†å›¾çš„è°ƒæ•´é€»è¾‘

### 2. MapCore (æ ¸å¿ƒåœ°å›¾ç»„ä»¶)

- **æ–‡ä»¶**: `MapCore.jsx` + `css/MapCore.css`
- **åŠŸèƒ½**:
  - è´Ÿè´£é«˜å¾·åœ°å›¾çš„åˆå§‹åŒ–
  - å¤„ç†åœ°å›¾åŠ è½½å’Œé”™è¯¯äº‹ä»¶
  - æä¾›åœ°å›¾å®ä¾‹ç»™å…¶ä»–ç»„ä»¶

### 3. MapMarkers (æ ‡è®°ç®¡ç†ç»„ä»¶)

- **æ–‡ä»¶**: `MapMarkers.jsx` + `css/MapMarkers.css`
- **åŠŸèƒ½**:
  - ç®¡ç†åœ°å›¾ä¸Šçš„æ‰€æœ‰æ ‡è®°ç‚¹
  - å¤„ç†æ ‡è®°çš„æ‰¹é‡æ¸²æŸ“å’Œäº‹ä»¶
  - æ˜¾ç¤ºæ‚¬åœæ—¶çš„ä¿¡æ¯çª—å£

### 4. MapRoutes (è·¯çº¿ç®¡ç†ç»„ä»¶)

- **æ–‡ä»¶**: `MapRoutes.jsx` + `css/MapRoutes.css`
- **åŠŸèƒ½**:
  - ç»˜åˆ¶ä¸åŒå¤©æ•°çš„è·¯çº¿
  - ç®¡ç†è·¯çº¿é¢œè‰²å’Œæ ·å¼
  - å¤„ç†è·¯çº¿è§„åˆ’ API è°ƒç”¨

### 5. MapLoadingStates (çŠ¶æ€æ˜¾ç¤ºç»„ä»¶)

- **æ–‡ä»¶**: `MapLoadingStates.jsx` + `css/MapLoadingStates.css`
- **åŠŸèƒ½**:
  - æ˜¾ç¤ºåœ°å›¾åŠ è½½ä¸­çŠ¶æ€
  - æ˜¾ç¤ºé”™è¯¯çŠ¶æ€å’Œé‡è¯•æŒ‰é’®
  - æ˜¾ç¤ºåœ°å›¾æ›´æ–°ä¸­çŠ¶æ€

### 6. JourneyControls (è¡Œç¨‹æ§åˆ¶ç»„ä»¶)

- **æ–‡ä»¶**: `JourneyControls.jsx` + `css/JourneyControls.css`
- **åŠŸèƒ½**:
  - æä¾›è¡Œç¨‹æ˜¾ç¤º/éšè—åˆ‡æ¢
  - ç®¡ç†å¤©æ•°é€‰æ‹©æ§ä»¶
  - å¤„ç†å…¨é€‰/å–æ¶ˆå…¨é€‰é€»è¾‘

### 7. AMapComponent (å…¼å®¹æ€§åŒ…è£…ç»„ä»¶)

- **æ–‡ä»¶**: `AMapComponent.jsx` + `css/AMapComponent.css`
- **åŠŸèƒ½**:
  - ä¿æŒå‘åå…¼å®¹æ€§
  - ç®€å•åŒ…è£… MapContainer ç»„ä»¶
  - å¯¼å…¥æ‰€æœ‰å­ç»„ä»¶çš„æ ·å¼

## ä¼˜åŠ¿

### 1. å•ä¸€èŒè´£åŸåˆ™

- æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½
- ä»£ç æ›´æ˜“ç†è§£å’Œç»´æŠ¤

### 2. å¯å¤ç”¨æ€§

- å„ç»„ä»¶å¯ä»¥ç‹¬ç«‹ä½¿ç”¨
- ä¾¿äºåœ¨å…¶ä»–é¡¹ç›®ä¸­å¤ç”¨

### 3. æ›´å¥½çš„æ€§èƒ½

- ç»„ä»¶æŒ‰éœ€æ¸²æŸ“
- å‡å°‘ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“

### 4. æ›´å®¹æ˜“æµ‹è¯•

- æ¯ä¸ªç»„ä»¶å¯ä»¥ç‹¬ç«‹æµ‹è¯•
- é™ä½æµ‹è¯•çš„å¤æ‚åº¦

### 5. å›¢é˜Ÿåä½œ

- ä¸åŒå¼€å‘è€…å¯ä»¥å¹¶è¡Œå¼€å‘ä¸åŒç»„ä»¶
- å‡å°‘ä»£ç å†²çª

## ä½¿ç”¨æ–¹å¼

### ç›´æ¥ä½¿ç”¨åŸç»„ä»¶ (æ¨èï¼Œä¿æŒå…¼å®¹æ€§)

```jsx
import { AMapComponent } from './components/map';

function App() {
  return <AMapComponent />;
}
```

### ä½¿ç”¨æ–°çš„å®¹å™¨ç»„ä»¶

```jsx
import { MapContainer } from './components/map';

function App() {
  return <MapContainer />;
}
```

### è‡ªå®šä¹‰ç»„åˆä½¿ç”¨

```jsx
import {
  MapCore,
  MapMarkers,
  MapRoutes,
  JourneyControls,
} from './components/map';

function CustomMapComponent() {
  // è‡ªå®šä¹‰é€»è¾‘
  return (
    <div>
      <MapCore onMapReady={handleMapReady} />
      <MapMarkers map={map} locations={locations} />
      <MapRoutes map={map} locations={locations} />
      <JourneyControls {...journeyProps} />
    </div>
  );
}
```

## æ–‡ä»¶ç»“æ„

```
src/components/map/
â”œâ”€â”€ AMapComponent.jsx           # åŸç»„ä»¶(å…¼å®¹æ€§åŒ…è£…)
â”œâ”€â”€ MapContainer.jsx            # ä¸»å®¹å™¨ç»„ä»¶
â”œâ”€â”€ MapCore.jsx                 # æ ¸å¿ƒåœ°å›¾ç»„ä»¶
â”œâ”€â”€ MapMarkers.jsx              # æ ‡è®°ç®¡ç†ç»„ä»¶
â”œâ”€â”€ MapRoutes.jsx               # è·¯çº¿ç®¡ç†ç»„ä»¶
â”œâ”€â”€ MapLoadingStates.jsx        # çŠ¶æ€æ˜¾ç¤ºç»„ä»¶
â”œâ”€â”€ JourneyControls.jsx         # è¡Œç¨‹æ§åˆ¶ç»„ä»¶
â”œâ”€â”€ Card.jsx                    # ä¿¡æ¯å¡ç‰‡ç»„ä»¶(åŸæœ‰)
â”œâ”€â”€ JourneyDetail.jsx           # è¡Œç¨‹è¯¦æƒ…ç»„ä»¶(åŸæœ‰)
â”œâ”€â”€ index.js                    # ç»Ÿä¸€å¯¼å‡º
â””â”€â”€ css/
    â”œâ”€â”€ AMapComponent.css       # å…¼å®¹æ€§æ ·å¼(å¯¼å…¥å…¶ä»–æ ·å¼)
    â”œâ”€â”€ MapContainer.css        # ä¸»å®¹å™¨æ ·å¼
    â”œâ”€â”€ MapCore.css             # æ ¸å¿ƒåœ°å›¾æ ·å¼
    â”œâ”€â”€ MapMarkers.css          # æ ‡è®°æ ·å¼
    â”œâ”€â”€ MapRoutes.css           # è·¯çº¿æ ·å¼
    â”œâ”€â”€ MapLoadingStates.css    # çŠ¶æ€æ˜¾ç¤ºæ ·å¼
    â”œâ”€â”€ JourneyControls.css     # è¡Œç¨‹æ§åˆ¶æ ·å¼
    â”œâ”€â”€ Card.css                # ä¿¡æ¯å¡ç‰‡æ ·å¼(åŸæœ‰)
    â””â”€â”€ JourneyDetail.css       # è¡Œç¨‹è¯¦æƒ…æ ·å¼(åŸæœ‰)
```

## è¿ç§»æŒ‡å—

ç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹ï¼ŒåŸæœ‰çš„ `AMapComponent` ç»„ä»¶ä»ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚æ–°çš„ç»„ä»¶æ¶æ„å®Œå…¨å‘åå…¼å®¹ã€‚

å¦‚æœè¦ä½¿ç”¨æ–°çš„ç»„ä»¶æ¶æ„ï¼Œå¯ä»¥ï¼š

1. ç›´æ¥æ›¿æ¢ `AMapComponent` ä¸º `MapContainer`
2. æˆ–è€…æ ¹æ®éœ€è¦é€‰æ‹©æ€§ä½¿ç”¨ç‰¹å®šçš„å­ç»„ä»¶

## æ³¨æ„äº‹é¡¹

1. æ‰€æœ‰å­ç»„ä»¶éƒ½ä¾èµ–é«˜å¾·åœ°å›¾ API çš„å…¨å±€ `window.AMap` å¯¹è±¡
2. ç»„ä»¶é—´é€šè¿‡ props è¿›è¡Œé€šä¿¡ï¼Œä¿æŒæ•°æ®æµå‘æ¸…æ™°
3. çŠ¶æ€ç®¡ç†ä»ç„¶é€šè¿‡ `JourneyContext` è¿›è¡Œ
4. CSS æ¨¡å—åŒ–ï¼Œé¿å…æ ·å¼å†²çª

## æœ€æ–°æ›´æ–°

### v1.1 - äº¤äº’åŠŸèƒ½ä¼˜åŒ– (2024-09-22)

#### ğŸ¯ æ–°å¢åŠŸèƒ½ï¼š

- **ç‚¹å‡»å¤©æ•°å¿«é€Ÿè·³è½¬**: ç‚¹å‡»å¤©æ•°æ–‡å­—ï¼ˆå¦‚"ç¬¬ 1 å¤©"ï¼‰å¯ä»¥åªæŸ¥çœ‹è¯¥å¤©çš„æ™¯ç‚¹å¹¶è‡ªåŠ¨è·³è½¬
- **æ™ºèƒ½åœ°å›¾è§†å›¾è°ƒæ•´**: ä½¿ç”¨é«˜å¾·åœ°å›¾çš„ `setFitView` æ–¹æ³•è‡ªåŠ¨è°ƒæ•´åœ°å›¾è§†å›¾ä»¥åŒ…å«æ‰€æœ‰é€‰ä¸­çš„æ™¯ç‚¹
- **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**: æ·»åŠ äº†ä½¿ç”¨æç¤ºå’Œè§†è§‰åé¦ˆ

#### ğŸ”§ æŠ€æœ¯æ”¹è¿›ï¼š

- åœ¨ `JourneyContext` ä¸­æ–°å¢ `setSelectedDays` æ–¹æ³•ï¼Œæ”¯æŒç›´æ¥è®¾ç½®é€‰ä¸­å¤©æ•°
- ä¼˜åŒ– `MapContainer` ä¸­çš„ `adjustMapView` å‡½æ•°ï¼Œä½¿ç”¨è¾¹ç•Œè®¡ç®—æ›¿ä»£ç®€å•çš„ä¸­å¿ƒç‚¹è®¡ç®—
- ä¸ºå¤©æ•°æ§ä»¶æ·»åŠ ç‚¹å‡»å’Œæ‚¬åœçš„è§†è§‰æ•ˆæœ

#### ğŸ“± ä½¿ç”¨æ–¹å¼ï¼š

- **å¤é€‰æ¡†**: ç”¨äºå¤šé€‰å¤©æ•°ï¼ˆä¿æŒåŸæœ‰é€»è¾‘ï¼‰
- **å¤©æ•°æ–‡å­—**: ç‚¹å‡»å¯å•ç‹¬æŸ¥çœ‹è¯¥å¤©æ™¯ç‚¹ï¼ˆæ–°åŠŸèƒ½ï¼‰
- **è‡ªåŠ¨ç¼©æ”¾**: åœ°å›¾ä¼šè‡ªåŠ¨è°ƒæ•´åˆ°åˆé€‚çš„ç¼©æ”¾çº§åˆ«ä»¥æ˜¾ç¤ºæ‰€æœ‰é€‰ä¸­çš„æ™¯ç‚¹

#### ğŸ¨ ç•Œé¢ä¼˜åŒ–ï¼š

- å½“å‰å•ç‹¬é€‰ä¸­çš„å¤©æ•°ä¼šé«˜äº®æ˜¾ç¤ºï¼ˆè“è‰²+ä¸‹åˆ’çº¿+åŠ ç²—ï¼‰
- æ·»åŠ å·¥å…·æç¤ºå’Œä½¿ç”¨è¯´æ˜
- é¼ æ ‡æ‚¬åœæ•ˆæœæ›´åŠ å‹å¥½
